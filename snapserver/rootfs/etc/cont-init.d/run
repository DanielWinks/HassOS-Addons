#!/usr/bin/with-contenv bashio

pipe=/tmp/snapfifo
if [[ ! -p $pipe ]]; then
  mkfifo $pipe ||
    bashio::exit.nok "Could not create named pipe!"
  chmod 666 $pipe ||
    bashio::exit.nok "Could not set permissions on pipe!"
fi

pipe=/tmp/snap_librespot1
if [[ ! -p $pipe ]]; then
  mkfifo $pipe ||
    bashio::exit.nok "Could not create named pipe for Librespot1!"
  chmod 666 $pipe ||
    bashio::exit.nok "Could not set permissions on pipe for Librespot1!"
fi

pipe=/tmp/snap_librespot2
if [[ ! -p $pipe ]]; then
  mkfifo $pipe ||
    bashio::exit.nok "Could not create named pipe for Librespot2!"
  chmod 666 $pipe ||
    bashio::exit.nok "Could not set permissions on pipe for Librespot2!"
fi

if ! bashio::fs.directory_exists '/data/snapcast'; then
  mkdir -p /data/snapcast ||
    bashio::exit.nok "Could not create Snapcast config folder!"
fi
